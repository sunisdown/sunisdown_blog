<!doctype html>
<html lang="zh" itemscope itemtype="http://schema.org/Person">
<head>
            <meta charset="utf-8">
        <!-- Site Meta Data -->
        <title>可扩展服务设计原则 checklist</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="sunisdown">

        <link rel="shortcut icon" href="">

        <!-- schema.org -->
        <meta itemprop="name" content="SunisDown">
        <meta itemprop="image" content="">
        <meta itemprop="description" content="">

        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
        <!-- Style Meta Data -->
        <link rel="stylesheet" href="http://sunisdown.me/theme/css/style.css" type="text/css"/>
        <link rel="stylesheet" href="http://sunisdown.me/theme/css/pygments.css" type="text/css"/>

        <!-- Feed Meta Data -->
            <link href="http://sunisdown.me/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="SunisDown ATOM Feed"/>

        <!-- Twitter Feed -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="">
        <meta name="twitter:image" content="">

    <meta name="twitter:creator" content="">
    <meta name="twitter:url" content="http://sunisdown.me/ke-kuo-zhan-fu-wu-she-ji-yuan-ze-checklist.html">
    <meta name="twitter:title" content="SunisDown ~ 可扩展服务设计原则 checklist">
    <meta name="twitter:description" content="这篇十多年之前写的论文基本包含设计一个可扩展服务的要点，我们现在玩的 cloud-native 早在很多年前就已经被大佬们整理的很透彻了。 这个是基于 James Hamilton 的 paper 来总结的 http://mvdirona.com/jrh/talksandpapers/jamesrh_lisa.pdf 基本原则 [ ] Expect failures 硬盘可能会坏，网络会不稳定，系统设计的时候是不是能够优雅的处理各种异常？ [ ] Keep things simple 复杂会导致更多的问题，简单的系统更容易正确的运行。去掉不必要的依赖等 [ ] Automate everything 使人都会犯错，把所有能够自动化的都自动化。 整体设计 [ ] 发生故障的时候，系统能否在没有人工干预的情况下自动恢复 [ ] 故障恢复的路径需要经常被测试 [ ] 把各个不同的组件都文档化，而不是每次了解某一个部分都需要看代码 [ ] 是否只提供一个版本给用户（单一版本迭代成本更低 [ ] 多租户，是否需要在没有物理隔离的情况下提供多租户功能 [ ] health check 是否实现了自动且快速的故障检测 [ ] 当你依赖的系统有问题的时候，能否服务降级 [ ] 相同那个的功能，只需要在一个应用里面实现 …">

    <!-- Facebook Meta Data -->
    <meta property="og:title" content="SunisDown ~ 可扩展服务设计原则 checklist"/>
    <meta property="og:description" content="这篇十多年之前写的论文基本包含设计一个可扩展服务的要点，我们现在玩的 cloud-native 早在很多年前就已经被大佬们整理的很透彻了。 这个是基于 James Hamilton 的 paper 来总结的 http://mvdirona.com/jrh/talksandpapers/jamesrh_lisa.pdf 基本原则 [ ] Expect failures 硬盘可能会坏，网络会不稳定，系统设计的时候是不是能够优雅的处理各种异常？ [ ] Keep things simple 复杂会导致更多的问题，简单的系统更容易正确的运行。去掉不必要的依赖等 [ ] Automate everything 使人都会犯错，把所有能够自动化的都自动化。 整体设计 [ ] 发生故障的时候，系统能否在没有人工干预的情况下自动恢复 [ ] 故障恢复的路径需要经常被测试 [ ] 把各个不同的组件都文档化，而不是每次了解某一个部分都需要看代码 [ ] 是否只提供一个版本给用户（单一版本迭代成本更低 [ ] 多租户，是否需要在没有物理隔离的情况下提供多租户功能 [ ] health check 是否实现了自动且快速的故障检测 [ ] 当你依赖的系统有问题的时候，能否服务降级 [ ] 相同那个的功能，只需要在一个应用里面实现 …"/>
    <meta property="og:image" content=""/>
</head>

<body>
<!-- Sidebar -->
<aside>
    <!--<center><a href="http://sunisdown.me"><img id="avatar" src=""></a></center>-->
    <h1>SunisDown</h1>
    <br>


    <nav class="nav">
        <ul class="list-bare">

                <li><a class="nav__link" href="/index.html">Blog</a></li>
                <li><a class="nav__link" href="/archives.html">Archives</a></li>
                <li><a class="nav__link" href="/tags.html">Tags</a></li>

                <li><a class="nav__link" href="http://sunisdown.me/pages/about.html">About</a></li>

        </ul>
    </nav>

    <p class="social">
                <a href="http://1024.today" target="_blank"><img
                        src="http://sunisdown.me/theme/images/icons/notebook.png"></a>
                <a href="https://twitter.com/SunisD0wn" target="_blank"><img
                        src="http://sunisdown.me/theme/images/icons/twitter.png"></a>
                <a href="https://github.com/sunisdown" target="_blank"><img
                        src="http://sunisdown.me/theme/images/icons/github.png"></a>
            <a href="http://sunisdown.me/feeds/all.atom.xml" rel="alternate">
                <img src="http://sunisdown.me/theme/images/icons/rss.png"></a>
    </p>

        <h2>Categories</h2>
        <ul class="navbar">
                <li class="active"><a
                        href="http://sunisdown.me/category/articles.html">articles</a></li>
        </ul>


</aside>

<!-- Content -->
<article>
    <section id="content">
        <article>
            <h2 class="post_title post_detail"><a href="http://sunisdown.me/ke-kuo-zhan-fu-wu-she-ji-yuan-ze-checklist.html" rel="bookmark"
                                                  title="Permalink to 可扩展服务设计原则 checklist">可扩展服务设计原则 checklist</a></h2>
            <div class="entry-content blog-post">
                <p>这篇十多年之前写的论文基本包含设计一个可扩展服务的要点，我们现在玩的
cloud-native 早在很多年前就已经被大佬们整理的很透彻了。 这个是基于 James
Hamilton 的 paper 来总结的
<a class="reference external" href="http://mvdirona.com/jrh/talksandpapers/jamesrh_lisa.pdf">http://mvdirona.com/jrh/talksandpapers/jamesrh_lisa.pdf</a></p>
<div class="section" id="id1">
<h2>基本原则</h2>
<ul class="simple">
<li>[ ] Expect failures
硬盘可能会坏，网络会不稳定，系统设计的时候是不是能够优雅的处理各种异常？</li>
<li>[ ] Keep things simple
复杂会导致更多的问题，简单的系统更容易正确的运行。去掉不必要的依赖等</li>
<li>[ ] Automate everything 使人都会犯错，把所有能够自动化的都自动化。</li>
</ul>
</div>
<div class="section" id="id2">
<h2>整体设计</h2>
<ul class="simple">
<li>[ ] 发生故障的时候，系统能否在没有人工干预的情况下自动恢复</li>
<li>[ ] 故障恢复的路径需要经常被测试</li>
<li>[ ] 把各个不同的组件都文档化，而不是每次了解某一个部分都需要看代码</li>
<li>[ ] 是否只提供一个版本给用户（单一版本迭代成本更低</li>
<li>[ ] 多租户，是否需要在没有物理隔离的情况下提供多租户功能</li>
<li>[ ] health check 是否实现了自动且快速的故障检测</li>
<li>[ ] 当你依赖的系统有问题的时候，能否服务降级</li>
<li>[ ]
相同那个的功能，只需要在一个应用里面实现，没有必要实现多次，会增加维护成本。</li>
<li>[ ]
服务需要能够单独运行，而不是必须要依赖于某个其他的服务才可以正常运行。</li>
<li>[ ] 针对少数需要人工干预的情况，需要准备好文档，脚本，测试方案等。</li>
<li>[ ]
保持系统简单的架构，如果是为了优化性能而增加复杂度，则需要这个性能上的改进超过一个数量级，只有几个百分点的改进不值得增加系统复杂成都。</li>
<li>[ ] 所有层级的入口都应该有准入机制，比如 rate
limit，防止量过大导致服务不可用</li>
<li>[ ] 能否拆分服务，拆分的是否合理</li>
<li>[ ] 分布式环境下，我们是否了解里面的网络拓扑，这个是否找网络方面专家
review 过</li>
<li>[ ] 是否分析过吞吐量与延迟，是否有对应的扩容方案</li>
<li>[ ]
对于这个服务给数据库/数据服务带来的流量是否有一个明确的理解，是否验证过。</li>
<li>[ ] 是否所有的系统，都是在同一套工具链下完成的，比如相同的 code
review，测试环境等</li>
<li>[ ] 版本化，保留之前的版本，测试用例，万一需要回滚呢</li>
<li>[ ] 单点故障是不可接受的</li>
</ul>
</div>
<div class="section" id="id3">
<h2>自动化管理</h2>
<ul class="simple">
<li>[ ] 所有的服务都需要支持重启</li>
<li>[ ] 所有持久化的数据都需要备份</li>
<li>[ ]
设计上需要支持跨数据中心部署（如果设计是不做，后面要实现就会比较麻烦）</li>
<li>[ ] 部署/配置自动化</li>
<li>[ ] 配置与代码需要一起交付，不要 version A的代码用了 version B
的配置。</li>
<li>[ ] 线上的更改，需要有记录，what，when，whom，which servers
，定时扫描线上版本，以免出现不一致的情况。</li>
<li>[ ] 按照角色来来管理服务，而不是面向服务来管理。</li>
<li>[ ] 系统出现多种故障的时候，服务是否能够正常工作</li>
<li>[ ] 重要的数据不要依赖于本地存储，很容易丢数据。</li>
<li>[ ] 部署过程是否简单？</li>
<li>[ ] chaos monkey 是个好东西</li>
</ul>
</div>
<div class="section" id="id4">
<h2>依赖管理</h2>
<ul class="simple">
<li>[ ] 能否容忍 latency 比较高的情况</li>
<li>[ ] 服务调用是否有超时机制</li>
<li>[ ] 超时重试是否有限制次数</li>
<li>[ ] 是否有CB 机制</li>
<li>[ ] 是否有快速失败机制</li>
<li>[ ] 依赖的组件是否可靠，验证过？</li>
<li>[ ] 跨服务的监控告警有吗</li>
<li>[ ] 依赖双方要有一直的设计目标</li>
<li>[ ] 模块解耦，依赖的组件挂了，也要能够服务（服务降级）</li>
</ul>
</div>
<div class="section" id="id5">
<h2>发布周期与测试</h2>
<ul class="simple">
<li>[ ]
是否频繁发布，发布频繁可以减少出错的机会，发布周期太长是很危险的（3个月）</li>
<li>[ ] 是否对用户体验定义了标准，是否有测试这些标准</li>
<li>[ ] 能否回滚到某一个指定版本</li>
<li>[ ] 可以在单节点上部署测试嘛？</li>
<li>[ ] 有压测嘛</li>
<li>[ ] 新版本发布之前的测试（性能，吞吐量，latency）</li>
<li>[ ] 可以使用 production 来测试嘛</li>
<li>[ ] 是否有跟生成环境完全一直的环境，并用相同的数据进行大规模测试</li>
<li>[ ] 有监控系统吗</li>
<li>[ ] 监控系统能明显的看出系统的各种重要指标嘛</li>
<li>[ ] 能否减少误报</li>
</ul>
</div>
<div class="section" id="id6">
<h2>硬件选择与标准化</h2>
<p>这个老哥在论文里面教了怎么购买硬件，怎么搞机柜。Google
有一本更专业的书来说这个事儿，这里不总结了。</p>
</div>
<div class="section" id="id7">
<h2>运维与容量规划。</h2>
<ul class="simple">
<li>[ ] devops, 谁开发，谁治理。</li>
<li>[ ] 只做软删除，要能够恢复被误删的数据</li>
<li>[ ] 跟踪资源分配</li>
<li>[ ]
一次只做一项更改（排查问题是，一次只对应用做一次更改，方便溯源问题）</li>
<li>[ ]
配置一切，如果可以通过更新配置来完成，而不是更改代码，这样会方便很多</li>
</ul>
</div>
<div class="section" id="id8">
<h2>审计，监控与告警</h2>
<ul class="simple">
<li>[ ] 监控一切</li>
<li>[ ] 统计有问题但是没有告警的情况，把这个比例降低到0</li>
<li>[ ] 分析数据，理解那些是正常的行为，避免误报。</li>
<li>[ ] 数据是最有价值的资源，帮助我们追溯问题。</li>
<li>[ ] 日志 Level是否可以配置，而不是重启，可配置的日志 Level
可以在需要的时候，输出更详细的日志帮助排问题。</li>
<li>[ ]
所有发现的错误都要及时处理，如果有错误但是没有处理手段，那这个错误就可能会被长期忽略，最终导致灾难发生</li>
<li>[ ] 快速定位线上问题</li>
<li>[ ] 能否镜像一个线上的系统，在镜像系统调试问题</li>
</ul>
</div>
<div class="section" id="id9">
<h2>优雅的降级与准入机制</h2>
<ul class="simple">
<li>[ ] 是否有 红按钮 机制，支持拒绝不重要的请求</li>
<li>[ ] 准入控制，拒绝部分请求</li>
<li>[ ] 渐入式准入控制，慢慢放开流量，以便系统能够优化恢复</li>
</ul>
</div>
<div class="section" id="id10">
<h2>客户沟通计划</h2>
<ul class="simple">
<li>[ ]
针对大规模系统不可用，数据丢失或损坏，安全漏洞等，是否制定了沟通计划，想之前腾讯云那种情况，就是缺乏沟通导致的</li>
</ul>
</div>
<div class="section" id="id11">
<h2>客户自助</h2>
<ul class="simple">
<li>[ ] 客户自行配置可以降低成本，并提高满意度，支持客户自助也相对重要。</li>
</ul>
</div>

            </div>
            <div class="post_list">
                <span>By </span>
                <a href="http://sunisdown.me/author/sunisdown.html">@SunisDown</a>
                <span> in </span>
                <span class="post_category"><a href="http://sunisdown.me/category/articles.html" rel="bookmark"
                                               title="Permalink to articles">[ articles ]</a></span>
                <span class="post_date">Mon 11 February 2019</span>
                <div><span>Tags : </span>
                            <span><a href="http://sunisdown.me/tag/system.html">#system, </a></span>
                </div>

                <div class="entry-social">
                    <span class="twitter"><a target="_blank" rel="nofollow"
                                             onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;"
                                             title="Twitter"
                                             href="https://twitter.com/share?url=http://sunisdown.me/ke-kuo-zhan-fu-wu-she-ji-yuan-ze-checklist.html&text=可扩展服务设计原则 checklist&via="><img
                            src="http://sunisdown.me/theme/images/icons/twitter-s.png"></a></span>

                    <span class="gplus"><a target="_blank" title="Google +"
                                           href="https://plus.google.com/share?url=http://sunisdown.me/ke-kuo-zhan-fu-wu-she-ji-yuan-ze-checklist.html&hl=fr"
                                           rel="nofollow"
                                           onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="http://sunisdown.me/theme/images/icons/google-s.png"></a></span>

                    <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow"
                                              onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;"
                                              href="https://www.facebook.com/sharer.php?u=http://sunisdown.me/ke-kuo-zhan-fu-wu-she-ji-yuan-ze-checklist.html&t=可扩展服务设计原则 checklist"><img
                            src="http://sunisdown.me/theme/images/icons/facebook-s.png"></a></span>

                    <a target="_blank" title="Linkedin"
                       href="https://www.linkedin.com/shareArticle?mini=true&url=http://sunisdown.me/ke-kuo-zhan-fu-wu-she-ji-yuan-ze-checklist.html&title=可扩展服务设计原则 checklist"
                       rel="nofollow"
                       onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img
                            src="http://sunisdown.me/theme/images/icons/linkedin-s.png"></a>

                    <span class="mail"><a
                            href="mailto:?subject=可扩展服务设计原则 checklist&amp;body=Viens découvrir un article à propos de [可扩展服务设计原则 checklist] sur le site de sunisdown. http://sunisdown.me/ke-kuo-zhan-fu-wu-she-ji-yuan-ze-checklist.html"
                            title="Share by Email" target="_blank"><img
                            src="http://sunisdown.me/theme/images/icons/mail-s.png"></a></span>
                </div>
            </div>
        </article>
    </section>
</article>

<!-- Footer -->
    <footer>
        <p>
            Blog powered by <a href="http://getpelican.com/">Pelican</a>,
            which takes great advantage of <a href="http://python.org">Python</a>.
            Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a
                href="https://parbhatpuri.com/">@parbhat</a>.
        </p>
    </footer>


</body>
</html>